<div class="container py-4">
  <div class="card shadow">
    <div class="card-header bg-white">
      <h4 class="mb-0">Customer Onboarding</h4>
    </div>

    <div class="card-body">
      <!-- Stepper -->
      <div class="mb-5">
        <div class="d-flex justify-content-between align-items-center position-relative">
          <div class="progress position-absolute w-100" style="height: 2px; top: 50%; z-index: 0;">
            <div class="progress-bar" role="progressbar"
                 [style.width]="((currentStep - 1) / (steps.length - 1) * 100) + '%'"></div>
          </div>

          <div *ngFor="let step of steps"
               class="d-flex flex-column align-items-center position-relative"
               style="z-index: 1;">
            <div [class]="'rounded-circle d-flex align-items-center justify-content-center ' +
                          (step.number <= currentStep ? 'bg-primary text-white' : 'bg-light text-muted')"
                 style="width: 40px; height: 40px; border: 2px solid;">
              <i *ngIf="step.completed" class="bi bi-check-lg"></i>
              <span *ngIf="!step.completed">{{ step.number }}</span>
            </div>
            <small class="mt-2 text-center">{{ step.title }}</small>
          </div>
        </div>
      </div>

      <!-- Error Message -->
      <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
        {{ errorMessage }}
      </div>

      <!-- Step 1: Basic Information -->
      <!-- <div *ngIf="currentStep === 1">
        <h5 class="mb-4">Step 1: Basic Information</h5>

        <form #basicInfoForm="ngForm">
          <div class="row g-3">
            <div class="col-md-6">
              <label for="clientCode" class="form-label">Client Code *</label>
              <input type="text" class="form-control" id="clientCode"
                     name="clientCode" [(ngModel)]="clientData.clientCode" required>
            </div>

            <div class="col-md-6">
              <label for="clientName" class="form-label">Client Name *</label>
              <input type="text" class="form-control" id="clientName"
                     name="clientName" [(ngModel)]="clientData.clientName" required>
            </div>

            <div class="col-md-6">
              <label for="clientEmail" class="form-label">Email *</label>
              <input type="email" class="form-control" id="clientEmail"
                     name="clientEmail" [(ngModel)]="clientData.clientEmail" required>
            </div>

            <div class="col-md-6">
              <label for="password" class="form-label">Password *</label>
              <input type="password" class="form-control" id="password"
                     name="password" [(ngModel)]="clientData.password" required>
            </div>

            <div class="col-md-6">
              <label for="businessType" class="form-label">Business Type *</label>
              <input type="text" class="form-control" id="businessType"
                     name="businessType" [(ngModel)]="clientData.clientBusinessType" required>
            </div>

            <div class="col-md-6">
              <label for="registerationNumber" class="form-label">Registration Number</label>
              <input type="text" class="form-control" id="registerationNumber"
                     name="registerationNumber" [(ngModel)]="clientData.registerationNumber">
            </div>

            <div class="col-12">
              <label for="address" class="form-label">Address *</label>
              <textarea class="form-control" id="address" rows="3"
                        name="address" [(ngModel)]="clientData.clientAddress" required></textarea>
            </div>
          </div>
        </form>
      </div> -->



      <!-- Step 1: Basic Information -->
<div *ngIf="currentStep === 1">
  <h5 class="mb-4">Step 1: Basic Information</h5>

  <form #basicInfoForm="ngForm">
    <div class="row g-3">
      <div class="col-md-6">
        <label for="clientName" class="form-label">Client Name *</label>
        <input type="text" class="form-control" id="clientName"
               name="clientName" [(ngModel)]="clientData.clientName" required>
      </div>

      <div class="col-md-6">
        <label for="clientEmail" class="form-label">Email *</label>
        <input type="email" class="form-control" id="clientEmail"
               name="clientEmail" [(ngModel)]="clientData.clientEmail" required>
      </div>

      <div class="col-md-6">
        <label for="clientPassword" class="form-label">Password *</label>
        <input type="password" class="form-control" id="clientPassword"
               name="clientPassword" [(ngModel)]="clientData.clientPassword" required>
      </div>

      <div class="col-md-6">
        <label for="clientBusinessType" class="form-label">Business Type *</label>
        <input type="text" class="form-control" id="clientBusinessType"
               name="clientBusinessType" [(ngModel)]="clientData.clientBusinessType" required>
      </div>

      <div class="col-12">
        <label for="address" class="form-label">Address *</label>
        <textarea class="form-control" id="address" rows="3"
                  name="address" [(ngModel)]="clientData.clientAddress" required></textarea>
      </div>
    </div>
  </form>
</div>

      <!-- Step 2: Document Upload -->
      <div *ngIf="currentStep === 2">
        <h5 class="mb-4">Step 2: Document Upload</h5>

        <!-- Identity Proof -->
        <div class="mb-4">
          <label class="form-label">Identity Proof (Required) *</label>
          <div class="border rounded p-4 text-center"
               [class.border-primary]="isDragging"
               (drop)="onDrop($event, 'Identity')"
               (dragover)="onDragOver($event)"
               (dragleave)="onDragLeave($event)">
            <i class="bi bi-cloud-upload fs-1 text-muted"></i>
            <p class="mb-2">Drag and drop files here or click to browse</p>
            <p class="text-muted small mb-2">Accepted: PDF, JPG, PNG (Max 5MB)</p>
            <input type="file" class="d-none" #identityInput
                   accept=".pdf,.jpg,.jpeg,.png" multiple
                   (change)="onFileSelect($event, 'Identity')">
            <button type="button" class="btn btn-outline-primary btn-sm"
                    (click)="identityInput.click()">
              Browse Files
            </button>
          </div>
        </div>

        <!-- Address Proof -->
        <div class="mb-4">
          <label class="form-label">Address Proof (Required) *</label>
          <div class="border rounded p-4 text-center"
               (drop)="onDrop($event, 'Address')"
               (dragover)="onDragOver($event)"
               (dragleave)="onDragLeave($event)">
            <i class="bi bi-cloud-upload fs-1 text-muted"></i>
            <p class="mb-2">Drag and drop files here</p>
            <input type="file" class="d-none" #addressInput
                   accept=".pdf,.jpg,.jpeg,.png" multiple
                   (change)="onFileSelect($event, 'Address')">
            <button type="button" class="btn btn-outline-primary btn-sm"
                    (click)="addressInput.click()">
              Browse Files
            </button>
          </div>
        </div>

        <!-- Additional Documents -->
        <div class="mb-4">
          <label class="form-label">Additional Documents (Optional)</label>
          <div class="border rounded p-4 text-center"
               (drop)="onDrop($event, 'Additional')"
               (dragover)="onDragOver($event)"
               (dragleave)="onDragLeave($event)">
            <i class="bi bi-cloud-upload fs-1 text-muted"></i>
            <p class="mb-2">Drag and drop files here</p>
            <input type="file" class="d-none" #additionalInput
                   accept=".pdf,.jpg,.jpeg,.png" multiple
                   (change)="onFileSelect($event, 'Additional')">
            <button type="button" class="btn btn-outline-primary btn-sm"
                    (click)="additionalInput.click()">
              Browse Files
            </button>
          </div>
        </div>

        <!-- Uploaded Files List -->
        <div *ngIf="uploadedFiles.length > 0" class="mt-4">
          <h6>Uploaded Files:</h6>
          <div class="list-group">
            <div *ngFor="let fileData of uploadedFiles; let i = index"
                 class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <i class="bi bi-file-earmark-pdf me-2"></i>
                <span>{{ fileData.file.name }}</span>
                <small class="text-muted ms-2">({{ (fileData.file.size / 1024 / 1024).toFixed(2) }} MB)</small>
                <span class="badge bg-secondary ms-2">{{ fileData.docType }}</span>
              </div>
              <button type="button" class="btn btn-sm btn-danger" (click)="removeFile(i)">
                <i class="bi bi-x-lg"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3: Verification Summary -->
      <div *ngIf="currentStep === 3">
        <h5 class="mb-4">Step 3: Verification Summary</h5>

        <div class="alert alert-success">
          <i class="bi bi-check-circle me-2"></i>
          Client onboarding completed successfully!
        </div>

        <div class="card">
          <div class="card-body">
            <h6>Client Details:</h6>
            <dl class="row mb-0">
              <dt class="col-sm-3">Name:</dt>
              <dd class="col-sm-9">{{ clientData.clientName }}</dd>

              <dt class="col-sm-3">Email:</dt>
              <dd class="col-sm-9">{{ clientData.clientEmail }}</dd>

              <dt class="col-sm-3">Business Type:</dt>
              <dd class="col-sm-9">{{ clientData.clientBusinessType }}</dd>

              <dt class="col-sm-3">Documents:</dt>
              <dd class="col-sm-9">{{ uploadedFiles.length }} file(s) uploaded</dd>
            </dl>
          </div>
        </div>
      </div>

      <!-- Navigation Buttons -->
      <div class="d-flex justify-content-between mt-4">
        <button type="button" class="btn btn-outline-secondary"
                (click)="cancel()">
          Cancel
        </button>

        <div>
          <button *ngIf="currentStep > 1 && currentStep < 3"
                  type="button" class="btn btn-outline-primary me-2"
                  (click)="previousStep()">
            <i class="bi bi-arrow-left"></i> Back
          </button>

          <button *ngIf="currentStep < 3"
                  type="button" class="btn btn-primary"
                  (click)="nextStep()"
                  [disabled]="loading">
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
            {{ loading ? 'Processing...' : 'Next' }} <i class="bi bi-arrow-right"></i>
          </button>

          <button *ngIf="currentStep === 3"
                  type="button" class="btn btn-success"
                  (click)="completeOnboarding()">
            Complete <i class="bi bi-check-lg"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
